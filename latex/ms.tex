\documentclass[12pt, English]{article}
\usepackage{geometry}
\geometry{verbose,letterpaper,tmargin=2.54cm,bmargin=2.54cm,lmargin=2.54cm,rmargin=2.54cm}
%\usepackage{apacite}
\usepackage[natbibapa]{apacite}
%\renewcommand{\APACrefYearMonthDay}[3]{\APACrefYear{#1} 
%  \cite<pre>[post]{key}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amstext}
\usepackage{amsmath}
\usepackage{comment}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{boxedminipage}
\usepackage{oldgerm}
\usepackage{setspace}
\usepackage{booktabs}
\usepackage{wrapfig}
\usepackage{indentfirst}
\usepackage{mathptmx}
\usepackage{setspace}
\usepackage{lscape} 
\usepackage[mathlines]{lineno}
\renewcommand{\ttdefault}{mathptmx}
\usepackage[latin9]{inputenc}
\usepackage{bm}
\usepackage{relsize}
\usepackage[normalem]{ulem} %%
%\linenumbers
\usepackage{bm}
\setlength{\parindent}{20pt}
\usepackage[labelformat=empty,labelsep=none]{caption}
\usepackage[singlelinecheck=false]{caption}
\usepackage{color}
\def\RED#1{\textcolor{red}{#1}} %% 
\def\BLUE#1{\textcolor{blue}{#1}} %% 
\begin{document}

\title{Estimating migration rates for iteroparous species using kinship pairs found between populations}
\author{
Tetsuya Akita$^{a}$\thanks{
\emph{Corresponding author}:
    Fisheries Resources Institute, Fisheries Research and Education Agency, Kanagawa 236-8648, Japan.
    E-mail: akitatetsuya1981@affrc.go.jp} \\ 
   \small $^{a}$Fisheries Resources Institute, Fisheries Research and Education Agency, \\
   \small Kanagawa, 236-8648, Japan.
   }
\date{Manuscript Intended for \emph{Methods in Ecology and Evolution}, \today}
\maketitle

\begin{abstract}
本ノートでは，多回繁殖(iteroparity)する種を対象として，半兄弟ペア数から親魚による２つのサブ集団間の移動率を推定する理論($\hat{M}=N_1N_2H_{\rm obs}/(4n_1n_2)$)を紹介する。この推定式は、親をサンプルする通常の標識放流と同じである。もし、繁殖ポテンシャルの分布が集団間で異なっていても上記の式で問題ないことを示した。一方，サンプル数としては$\sqrt {N}$以上のオーダーが求められる。
\\
\end{abstract}
\textbf{Key words:} effective population size; sibship assignment; overdispersed reproduction; close-kin mark-recapture\\
\textbf{Running head:} Estimating migration rates using kinship pairs\\

\pagebreak
\begin{spacing}{1.9}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%FIGURE S1%%%
\newcommand{\NeNbias}{S1}
%%%%%%%%%%%

%%%FIGURE S2%%%
\newcommand{\Nebias}{S2}
%%%%%%%%%%%

%%%FIGURE S3%%%
\newcommand{\Ninvbias}{S3}
%%%%%%%%%%%

%%%FIGURE S4%%%
\newcommand{\NeNcv}{S4}
%%%%%%%%%%%

%%%FIGURE S5%%%
\newcommand{\Necv}{S5}
%%%%%%%%%%%

%%%FIGURE S6%%%
\newcommand{\Ninvcv}{S6}
%%%%%%%%%%%

\section{INTRODUCTION}

Estimating the number of migrants among the populations is essential for understanding population structure and dynamics, which is a fundamental process for implementing conservation and wildlife management. Especially in fisheries management, migration rate is a critical component for delineating a synchrony among the population, providing appropriate management units. There are essentially two approaches for estimating the migrant number. The first is to use the mark-recapture method estimate it directly from the population dynamics modeling with survey data. The second is to ...

移動率の推定は，対象生物の理解に重要なだけでなく，外来種管理・希少種保全・資源の持続的利用にとっても重要である。　特に、水産資源管理にとっては、管理単位を決めるための指標として、移動率はクリティカルな指標の一つである。既存の方法論としては，大きく２種類に大別される。１つ目は標識再捕法であり，２つ目は集団遺伝学的な方法である。前者については，サンプル対象を再捕獲が見込める親個体に限定せざるを得ない，非侵襲的な方法でのラベリングが困難であること，推定精度に見合うサンプルサイズが現実的でないこと，報告率が大きくばらつく等が問題となっている。後者については，近年(すなわち$N_{\rm e}$よりも短い世代数)の集団構造については解像度がないこと，移動個体数が大きいと遺伝的には同一の集団とみなされること等が問題となっている。

本ノートでは，近親標識法(Close-kin mark-recapture, CKMR)という近年発達した方法論を用いて，移動率の推定を試みる。CKMRとは，親集団が小さいほど近親ペアが見つかりやすいことに着目した方法である。今回は，多回繁殖する生物を対象として，２つのサブ集団間で見つかる０歳の半兄弟(Half-sibling, HS)ペアを用いて，そのペアの親候補となる個体の数（もしくは移動率）を推定する。ただし，移動前の集団および移動後の集団における親魚尾数が，移動個体数の推定には必要となる。

応用例として，３年間にわたって２つのサブ集団からサンプルされた当歳魚から見出される半兄弟ペアをもとに，個体数・移動率・生存率を推定する枠組みを提示する。そこでは，同じサブ集団から年を跨いで見つかる半兄弟ペアに基づく関係式と，今回新たに開発した関係式を組み合わせて用いる。

\section{Theory}\label{sec2}
In this section, we present the theoretical foundation for estimating a migrant number and a migration rate of iteroparous species using HS or PO pairs, which are found between two populations with a different sample timing. While the estimators can hold under flexible assumptions for reproduction (see {\bf Appendix 2}), here we assume a relatively simple situation for explanation purposes. The main symbols used in the current paper are summarized in {\bf Table \ref{symbols}}. 

%%%%%%%%%%%%%%
\begin{center}
\fbox{Table \ref{symbols} is here. }
\end{center}
%%%%%%%%%%%%%%

\subsection{Hypothetical population}

Suppose that we have a set of two populations labelled 1 and 2 where random mating occurs within each population and that parents can move to the other population after the end of the reproductive season. Hereafter, without loss of generality, we consider the movement of parents in the direction from population 1 to population 2 and focus on the migration number or rate, and that is what we attempt to estimate. In this framework, we show that considering two reproductive seasons (hereafter, we call them "the first year" and "the second year") is enough to estimate it. {\bf Figure \ref{cartoon}a} presents a schematic representation of the kinship relationships and movements of parents. 

Suppose there are $N_1$ parents in the population 1 at the beginning of the first year. Each parent produces offspring in which the number is governed by the parent's reproductive potential, denoted by $\lambda_{i,1}$ ($i=1,2,\ldots,N_1$). After the reproductive season, part of the parents would start to moving towards the population 2; $M$ survived migrants arrive in the population 2 so that there are $N_2$ parents in the population 2 at the beginning of the second year ($M \le N_1$ and $M \le N_2$). Similar to the population 1, $N_2$ parents produce offspring in which the number is governed by $\lambda_{j,2}$ ($j=1,2,\ldots,N_2$). The reproductive potential is determined by several factors and its details are summarized in {\bf Appendix 1}; theoretically speaking, the number of offspring for each parent is set as a random variable with mean $\lambda_{i,1}$ or $\lambda_{j,2}$. 

%%%%%%%%%%%%%%
\begin{center}
\fbox{Figure \ref{cartoon} is here. }
\end{center}
%%%%%%%%%%%%%%

\subsection{Sampling}

To estimate the migration number or rate, we utilize the number of HS and/or PO pairs observed in a sample. In the both populations, $n_{\rm O, 1}$ and $n_{\rm O, 2}$ offspring are randomly sampled in the first and second year, respectively, which are identified as young-of-year individuals without errors. Additionally, $n_{\rm P, 1}$ and $n_{\rm P, 2}$ parents are randomly sampled immediately after the end of the reproductive season in the first and second year, respectively. For mathematical tractability, parents have to survive during the reproductive season; therefore, both mother and father of a certain offspring have a potential to be sampled even in the same year. It should be noted that all the four kinds of a sample (i.e., $n_{\rm P, 1}$, $n_{\rm P, 2}$, $n_{\rm O, 1}$, and $n_{\rm O, 2}$) are not always required for estimating migration number or rate; what kinds of a sample are needed depends on the situation, as explained later. Up to the subsection 2.6, we only focus HS pairs and PO pairs found between the two populations. For the applicability of fishery management, we assume invasive sampling procedure, preventing the finding of a parent-offspring pair such that a parent and offspring is sampled in the population 1 and 2, respectively. {\bf Figure~\ref{cartoon}b} illustrates a timeline of sampling scheme for hypothetical populations. 

In the example depicted in {\bf Fig~\ref{cartoon}a}, five offspring and four parents are sampled in the population 1 and four offspring and six parents are sampled in the population 2, and two HS and one PO pairs found between the two populations are observed. In addition, there are several PO pairs observed within the same population, which are available to estimate parent numbers, as explained in the following section. In our modeling framework, if full-sibling (FS) relationship is found, we count it as two HS pairs. The numbers of HS and PO pairs found between the two populations are determined by pairwise comparison of all the sample individuals ($n_{\rm O,1}\times n_{\rm O,2}$ and $n_{\rm O,1}\times n_{\rm P,2}$ comparisons, respectively). 

\subsection{HS pair-based model}

Here, we consider the probability that two offspring sampled in the population 1 and 2 share an HS relationship with an arbitrary mother or father, denoted by $\pi_{\rm HS, bet}$. For the explanation purpose, we assume equal reproductive potential among parents up to the subsection 2.7, although this assumption can be relaxed for most of the case (see details in {\bf Appendix 2}). $\pi_{\rm HS, bet}$ can be partitioned into the three probabilities: (i) the probability that sampled offspring in the population 1 born to a parent that safely arrives in the population 2 (hereafter, called "migrant"); (ii) the probability that sampled offspring in the population 2 born to a migrant; and (iii) the probability that the migrant of a sampled offspring in the population 1 and the migrant of a sampled offspring in the population 2 are identical. 

To assess these probabilities, recall there must be two parents of arbitral offspring; the first probability is the sum of father-offspring and mother-offspring relationship, which can be written by $r_{\rm M}M/(r_{\rm S,1}N_{1}) + (1 - r_{\rm M})M/((1-r_{\rm S,1})N_{1})$, where $r_{\rm M}$ and $r_{\rm S,1}$ indicates sex ratio of parents in the migrants and in the whole of the population 1, respectively. Assuming $r_{\rm M} = r_{\rm S,1}$, the probability is simplified as $2M/N_{1}$. Similarly, the second probability is simplified as $2M/N_{2}$, implying the assumption of equal sex ratio in the migrants and the others. The third probability corresponds to the probability that randomly selected two migrants are identical, that is $1/M$. Taken together, we obtain
\begin{align}
\pi_{\rm HS,bet} &= \frac{2M}{N_{1}} \frac{2M}{N_{2}} \frac{1}{M} \nonumber\\
&= \frac{4M}{N_{1}N_{2}}.
\label{HS-1}
\end{align}
This form holds under a flexible setting for the reproductive potential, such as a situation with random variable of $\lambda_{i,1}$ and $\lambda_{j,2}$, as noted in {\bf Appendix 2}. If all $N_1$ parents safely move to the population 2 (i.e., $M = N_1$), $\pi_{\rm HS,bet}$ equals $4/N_2$; meanwhile, if the population 2 consists only of migrants (i.e., $M = N_2$), $\pi_{\rm HS,bet}$ equals $4/N_1$. These probabilities in the extreme cases are similar forms to HS probability that is randomly sampled from two different cohorts within a population \cite[]{bravington2016close}. 

Let $H_{\rm HS,bet}$ be the number of HS pairs found in offspring samples of size $n_{\rm O, 1}$ and $n_{\rm O, 2}$. Assuming that the total number of HS pairs in the population is much higher than $H_{\rm HS,bet}$, the distribution is approximated by a binomial form (i.e., $H_{\rm HS,bet} \sim {\rm Binom}[\pi_{\rm HS,bet}, n_{\rm O, 1} n_{\rm O, 2}]$); thus, the theoretical expectation of $H_{\rm HS,bet}$ is

\begin{align}
\mathbb{E}[H_{\rm HS, bet}] &= \pi_{\rm HS,bet} n_{\rm O, 1} n_{\rm O, 2} \nonumber\\
&= \frac{ 4 n_{\rm O, 1} n_{\rm O, 2} M } { N_{1} N_{2} } \label{HS-2-1}\\
&= \frac{ 4 n_{\rm O, 1} n_{\rm O, 2} m } { N_{2} },
\label{HS-2-2}
\end{align}
where $m$ indicates the migration rate satisfying $M = mN_{1}$. The observed number of HS pairs in a sample found between the two populations is defined by $\widetilde{H}_{\rm HS, bet}$, and $\mathbb{E}[H_{\rm HS, bet}]$ in Equation \ref{HS-2-1} is replaced by $\widetilde{H}_{\rm HS, bet}$, generating the linear estimator of $M$:

\begin{align}
\widehat{M_1} &= \frac{N_{1} N_{2} \widetilde{H}_{\rm HS, bet} } {4 n_{\rm O, 1} n_{\rm O, 2} }.
\label{HS-3}
\end{align}
In this paper, a ``tilde'' and ``hat'' indicates the observation and estimator of a variable, respectively. Similarly, $\mathbb{E}[H_{\rm HS, bet}]$ in Equation \ref{HS-2-2} is replaced by $\widetilde{H}_{\rm HS, bet}$, generating the linear estimator of $m$:

\begin{align}
\widehat{m_1} &= \frac{N_{2} \widetilde{H}_{\rm HS, bet} } {4 n_{\rm O, 1} n_{\rm O, 2} }
\label{HS-4}
\end{align}
Subscription of these estimators indicates the numbering of proposed estimators appeared in this paper, which is summarized in Table \ref{parameter}. 

%%%%%%%%%%%%%%
\begin{center}
\fbox{Table \ref{parameter} is here. }
\end{center}
%%%%%%%%%%%%%%

\subsection{PO pair-based model}

Next, we consider the probability that offspring sampled in the population 1 and a parent sampled in the population 2 share an PO relationship, denoted by $\pi_{\rm PO, bet}$. $\pi_{\rm PO, bet}$ can be partitioned into the three probabilities: (i) the probability that sampled offspring in the population 1 born to a migrant; (ii) the probability that a migrant is sampled; and (iii) the probability that the migrant of a sampled offspring in the population 1 and the migrant sampled in the population 2 are identical. The first and second probabilities are the same as the one introduced in the previous subsection, that is, $2M/N_{1}$ and $1/M$. The second probability is $M/N_{2}$ by definition. Taken together, we obtain
\begin{align}
\pi_{\rm PO,bet} &= \frac{2M}{N_{1}} \frac{M}{N_{2}} \frac{1}{M} \nonumber\\
&= \frac{2M}{N_{1}N_{2}}.
\label{PO-1}
\end{align}
This form also holds under a flexible setting for the reproductive potential, as noted in {\bf Appendix}. If all $N_1$ parents safely move to the population 2 (i.e., $M = N_1$), $\pi_{\rm PO,bet}$ equals $2/N_2$; meanwhile, if the population 2 consists only of migrants (i.e., $M = N_2$), $\pi_{\rm PO,bet}$ equals $2/N_1$. These probabilities in the extreme cases are similar forms to PO probability that is randomly sampled within a population \cite[]{bravington2016close}. 

Let $H_{\rm PO,bet}$ be the number of PO pairs found in offspring samples of size $n_{\rm O, 1}$ and parent samples of size $n_{\rm P, 2}$. Assuming that the total number of PO pairs in the two populations is much higher than $H_{\rm PO,bet}$, the distribution is approximated by a binomial form (i.e., $H_{\rm PO,bet} \sim {\rm Binom}[\pi_{\rm PO,bet}, n_{\rm O, 1} n_{\rm P, 2}]$); thus, the theoretical expectation of $H_{\rm PO,bet}$ is
\begin{align}
\mathbb{E}[H_{\rm PO, bet}] &= \pi_{\rm PO,bet} n_{\rm O, 1} n_{\rm P, 2} \nonumber\\
&= \frac{ 2 n_{\rm O, 1} n_{\rm P, 2} M } { N_{1} N_{2} } \label{PO-2-1} \\
&= \frac{ 2 n_{\rm O, 1} n_{\rm P, 2} m } { N_{2} }.
\label{PO-2-2}
\end{align}
The observed number of PO pairs in a sample is defined by $\widetilde{H}_{\rm PO, bet}$, and $\mathbb{E}[H_{\rm PO, bet}]$ in Equations \ref{PO-2-1} and \ref{PO-2-2} are replaced by $\widetilde{H}_{\rm PO, bet}$, generating the linear estimator of $M$ and $m$:
\begin{align}
\widehat{M_2} &= \frac{N_{1} N_{2} \widetilde{H}_{\rm PO,bet} } {2 n_{\rm O, 1} n_{\rm P, 2} },
\label{PO-3}
\end{align}
and
\begin{align}
\widehat{m_2} &= \frac{N_{2} \widetilde{H}_{\rm PO,bet} } {2 n_{\rm O, 1} n_{\rm P, 2} }.
\label{PO-4}
\end{align}

\subsection{Required sample size}

Proposed estimators are based on the observed number of kinship pairs. Their expected number is linearly determined by the number of pairwise comparison (Eqs.~\ref{HS-2-1}-\ref{HS-2-2} and \ref{PO-2-1}-\ref{PO-2-2}), providing guidance for a sample size to ensure the condition that at least one or more kinship pairs can be found. The conditions are given by
\begin{align}
n_{\rm O, 1} n_{\rm O, 2} &> \frac{ N_{2} } { 4m },
\label{RS-1}
\end{align}
and
\begin{align}
n_{\rm O, 1} n_{\rm P, 2} &> \frac{ N_{2} } { 2m }.
\label{RS-2}
\end{align}
Roughly speaking, required sample size to ensure above conditions is that $n>\sqrt{N_2}$, where $n = n_{\rm O, 1}=n_{\rm O, 2}=n_{\rm P, 2}$. It should be noted that very tiny $m$, which dramatically increases the required sample size, produces significant genetic differences between two populations. In such a case, there are several methods to estimate migration rate by population genetics technique; alternatively, we focus the situation of moderate/large migration rate, which leads little genetic differences between two populations (see details in {\bf Discussion} section). 

Other guidance for the required sample size is obtained by an approximate lower bound on the CV (coefficient of variation) of $M_1$ or $m_1$, defined by $1/\sqrt{H_{\rm HS, bet}}$, which is applied in the context of a classic mark-recapture \cite[]{seber1982estimation} or close-kin mark-recapture \cite[]{bravington2016close}. For example, to achieve a 30\% CV, the target of $H_{\rm HS, bet}$ is more than 10, providing the required sample size when population parameters are given (e.g., $N_1$, $N_2$ and $M$). Similarly, the CV of $M_2$ or $m_2$, defined by $1/\sqrt{H_{\rm PO, bet}}$, provides the required sample size for estimating $M_2$ or $m_2$. 

\subsection{Efficient use of kinship pairs found between populations}

When the both HS pairs and PO pairs, which are found between populations, are simultaneously available, we can obtain efficient estimators by combined $\widehat{M_1}$ and $\widehat{M_2}$ for migration number: 
\begin{align}
\widehat{M_3} &= \frac{ N_{1} N_{2} \left(\widetilde{H}_{\rm HS,bet} + \widetilde{H}_{\rm PO,bet}\right) } {2n_{\rm O, 1} \left(2 n_{\rm O, 2} + n_{\rm P, 2}\right) },
\label{AP-1}
\end{align}
and by combining $\widehat{m_1}$ and $\widehat{m_2}$ for migration rate: 
\begin{align}
\widehat{m_3} &= \frac{ N_{2} \left(\widetilde{H}_{\rm HS,bet} + \widetilde{H}_{\rm PO,bet}\right) } {2n_{\rm O, 1} \left(2 n_{\rm O, 2} + n_{\rm P, 2}\right)}.
\label{AP-2}
\end{align}
For those estimators, $\widetilde{H}_{\rm HS,bet}$ and $\widetilde{H}_{\rm PO,bet}$ is weighted by a sample size $n_{\rm O, 2}$ and $n_{\rm P, 2}$, respectively. 

\subsection{Estimation of parent number by PO pairs found within a population}

So far, we provide the formulation of the estimators, presented in Equations \ref{HS-3}-\ref{HS-4} and \ref{PO-3}-\ref{PO-4}, is a function with parent numbers for each population ($N_1$ and/or $N_2$); in other words, such estimators are available only when those parent number(s) are known. In this subsection, we provide the treatment for estimating the unknown parent numbers by additional usage of PO pairs, producing estimators for migrant number and migration rate that can be obtained only from the genetic data. 

When PO pairs found in offspring samples and parent samples both from the population 2 in the second year are available, standard estimator of parental number can be obtained \cite[]{bravington2016close}, given by

\begin{align}
\widehat{N_2} &= \frac{ 2 n_{\rm O, 2} n_{\rm P, 2} + 1 }{\widetilde{H}_{\rm PO, 2} + 1} ,
\label{AP-3}
\end{align}
where $\widetilde{H}_{\rm PO, 2}$ is the observed number of PO pairs found in offspring samples of size $n_{\rm O, 2}$ and parent samples of size $n_{\rm P, 2}$. The term ``$+1$'' reduces the bias especially when $\widetilde{H}_{\rm PO, 2}$ is small \cite[e.g.,][]{ecolevol2021p}, where a similar derivation of this bias correction is provided in \cite{Akita_2019}. By replacing $N_2$ by $\widehat{N_2}$ in Eqs.~\ref{AP-1} and \ref{AP-2}, we can obtain the following estimators: 

\begin{align}
\widehat{M_4} &=  \frac{ N_{1} \left(\widetilde{H}_{\rm HS,bet} + \widetilde{H}_{\rm PO,bet}\right) \left(2 n_{\rm O, 2} n_{\rm P, 2} + 1\right)} {2n_{\rm O, 1} \left(2 n_{\rm O, 2} + n_{\rm P, 2}\right) \left(\widetilde{H}_{\rm PO, 2} + 1\right)},
\label{AP-4}
\end{align}
and
\begin{align}
\widehat{m_4} &=  \frac{ \left(\widetilde{H}_{\rm HS,bet} + \widetilde{H}_{\rm PO,bet}\right) \left(2 n_{\rm O, 2} n_{\rm P, 2} + 1\right)} {2n_{\rm O, 1} \left(2 n_{\rm O, 2} + n_{\rm P, 2}\right) \left(\widetilde{H}_{\rm PO, 2} + 1\right)}.
\label{AP-5}
\end{align}
While estimator of the migrate number (Equation~\ref{AP-4}) requires the (unknown) parent number in the population 1 ($N_{1}$), estimator of the migration rate (Equation~\ref{AP-5}) can be obtained only the observed kinship pairs. 

Similar to estimating $N_2$, when PO pairs found in offspring samples and parent samples both from the population 1 in the first year are also available, we can obtain the estimator of $N_1$, written by
\begin{align}
\widehat{N_1} &= \frac{ 2 n_{\rm O, 1} n_{\rm P, 1} + 1 }{\widetilde{H}_{\rm PO, 1} + 1},
\label{AP-6}
\end{align}
where $\widetilde{H}_{\rm PO, 1}$ is the observed number of PO pairs found in offspring samples of size $n_{\rm O, 1}$ and parent samples of size $n_{\rm P, 1}$. By replacing $N_1$ by $\widehat{N_1}$ in Eq.~\ref{AP-4}, we can obtain the estimator of migration number that can be calculated only from genetic data, given by
\begin{align}
\widehat{M_5} &=  \frac{ \left(\widetilde{H}_{\rm HS,bet} + \widetilde{H}_{\rm PO,bet}\right) \left(2 n_{\rm O, 1} n_{\rm P, 1} + 1\right) \left(2 n_{\rm O, 2} n_{\rm P, 2} + 1\right)} {2n_{\rm O, 1} \left(2 n_{\rm O, 2} + n_{\rm P, 2}\right) \left(\widetilde{H}_{\rm PO, 1} + 1\right) \left(\widetilde{H}_{\rm PO, 2} + 1\right)}.
\label{AP-7}
\end{align}

Table \ref{parameter} summarizes the conditions for estimators appeared in this paper as to whether $N_1$ and/or $N_2$ are known and which type of samples are needed for estimation, and provides required kinship type for calculating the estimator. 

\subsection{Variation in reproductive potential among individuals and populations}

The proposed estimators are derived under the assumption that reproductive potential is the same among individuals. As noted in {\bf Appendix 2}, this assumption can be relaxed and the estimators still hold, which is exemplified in iteroparous species that may show significant variation in reproductive potential among individuals. Furthermore, the estimators even hold for most of the case where mean reproductive potential are different between population 1 and 2, which is exemplified in the situation that the environmental condition for reproductive success varies between populations. The necessary condition is that the migration event does not depends on the degree of reproductive potential (see details in  {\bf Appendix 3}). 

\subsection{Individual-based model}

We developed an individual-based model that tracks kinship relationships to evaluate the estimator's performance. The population structure was assumed to be identical to that in the development of the estimators. The population 1 and 2 comprised $N_1$ and $N_2$ parents with an equal sex ratio, and their offspring number was assumed to follow the geometric distribution with mean ${\bar \lambda_1}$ and ${\bar \lambda_2}$ (i.e., Poisson reproduction with mean $\lambda_{i,1}$ and $\lambda_{j,2}$ which follows the exponential distribution with mean ${\bar \lambda_1}$ and ${\bar \lambda_2}$), respectively. Migrant parents were randomly chosen from the population 1 at the end of the first year. Each offspring retained the parent's ID, making it possible to trace an HS and PO relationship.

Let a parameter set ($N_1$, $N_2$, $M$, ${\bar \lambda_1}$, ${\bar \lambda_2}$, $n_{\rm O,1}$, $n_{\rm O,2}$, $n_{\rm P,1}$, $n_{\rm P,2}$) be given. We simulated a population history and a sampling process, which generates proposed estimators; this process was repeated 1000 times, making it possible to construct the distribution of the estimators for each parameter set. All scripts and documentation for these analyses are available at \\https://github.com/teTUNAakita/CKMRmig.

\RED{kokomade!!!!!!!!!!!!!!!!!!!!}

\section{Results}\label{sec3}

We numerically evaluated the performance of ${\hat M}$ or ${\hat m}$ for the case in which variable reproductive potential among parents. Scaled statistical properties of ${\hat m_1}$,  ${\hat m_2}$,  ${\hat m_3}$ and ${\hat m_4}$ are completely the same to ${\hat M_1}$, ${\hat M_2}$, ${\hat M_3}$ and ${\hat M_4}$, hereafter, we only demonstrate the results of ${\hat M_1}$-${\hat M_5}$. {\bf Figure~\ref{violins}} illustrates the distribution of the relative bias of ${\hat M}$ for limiting cases where parent and offspring sample numbers are identical (i.e., $n=n_{\rm P,1}=n_{\rm P,2}=n_{\rm O,1}= n_{\rm O,2}$) and parent numbers in the two populations are also identical (i.e., $N=N_1=N_2$). Relative bias is calculated by applying outputs of the individual-based model, which is defined as follows: ``averaged estimator - true value/true value.'' Full list of parameter sets to evaluate the performance (relative bias and CV of ${\hat M}$) is summarized in {\bf Table S1} in {\bf Supporting Information}. 
 
%%%%%%%%%%%%%%
\begin{center}
\fbox{Figure \ref{violins} is here. }
\end{center}
%%%%%%%%%%%%%%

\subsection{Properties of ${\hat M}$}

%property of M_i (all are unbiased estimators (accuracy), M_3 shows the best performance (precision))

\subsection{Required sample size}

\subsection{Invasive sampling}

\subsection{Case of $N_1 \neq N_2$}




\section{Discussion}\label{sec4}





\begin{comment}

The estimation of the ratio of the contemporary effective population size to the census size ($N_{\rm e}/N$) has attracted much research attention for providing information about a current population, especially in the context of conservation biology and wildlife management \cite[]{Palstra_2012,FRANKHAM201456}. Small $N_{\rm e}/N$ demonstrates large variance in reproductive success \cite[]{Wang:2016aa, JFB:JFB13143, Akita_2019}, resulting from the variance of reproductive potential \cite[e.g., the big old fat fecund female fish hypothesis;][]{Hixon_2014} or from the situation in which only some families successfully reproduce \cite[referred to as the ``Sweepstakes reproductive success'' hypothesis,][]{hedgecock2011sweepstakes}. Moreover, if $N_{\rm e}/N$ is invariant across years, then $N_{\rm e}$ may behave like an index of $N$, and vice versa \cite[]{luikart2010estimation}. However, if $N_{\rm e}/N$ fluctuates across years, the trends can clarify the interpretation of environmental and/or anthropological factors, causing the variance of reproductive potential, family-correlated survivorship, or fluctuating population dynamics. Besides, low precision and/or large bias for estimating $N_{\rm e}/N$ may lead to a wrong interpretation of the population \cite[]{Tallmon:2012aa}.

The estimation of $N_{\rm e}/N$ has been performed by utilizing the estimated values of contemporary effective population size ($N_{\rm e}$) and census size ($N$), unless complete pedigree data and/or full census data are available. Additionally, there are numerous methods for estimating $N_{\rm e}$ from genetic markers \cite[][and the references contained therein]{Wang:2016aa}. There are also numerous methods for estimating $N$, such as a mark-recapture method or population dynamics modeling with survey data \cite[e.g.,][]{seber1982estimation,quinn1999quantitative,kery2011bayesian,methot2013stock}. It is known that there are large variations in both estimators; thus, their combination (i.e., the estimator of $N_{\rm e}/N$) also shows large variation \cite[]{Palstra_2012,Marandel_2018}. There is currently a little theoretical foundation for the estimator of $N_{\rm e}/N$, indicating no guidance for a sample size to ensure the required accuracy and precision. 

Close-kin mark-recapture (CKMR) is a recently developed method for estimating $N$ that utilizes the information about kinship in a sample. This was possible owing to the recent advances in genetic methods for kinship determination \cite[]{Bravington_2016,bravington2016close,skaug2017parent,Hillary_2018} although similar methods have been proposed in the beginning of the 21st century \cite[]{nielsen2001statistical, pearse2001genetic, julius2001allele}. Besides, the rationale is that the presence of a kinship pair in the sample is analogous to the recapture of a marked individual in mark-recapture. Kinship pairs in the sample are less likely to be observed in larger populations; thus, the number of kinship pairs may reflect $N$. While the original CKMR is designed to estimate adult abundance (i.e., $N$), the monitoring data for CKMR also produce the estimator of $N_{\rm e}$ by detecting half-sibling (HS) pairs within the same cohort \cite[]{Akita_2019}. This kinship-oriented estimation of $N_{\rm e}$ was presented in the context of the sibship assignment method \cite[]{wang2009new} and is expected to provide a much more accurate estimator as kinship determination becomes more accurate. 

In this study, we propose a new method for estimating the ratio of contemporary effective mother size to the census size ($N_{\rm e,m}/N_{\rm m}$) in a population, as a proxy of $N_{\rm e}/N$. Assuming that kinships are genetically detected without any error, this method is based on the numbers of maternal-sibling (MS) and mother--offspring (MO) pairs in a sample. Sampling is completed at a single breeding time; sampling offspring within the same cohort and mothers probably shares MO relationship with sampled offspring. Our model provides a nearly unbiased estimator of $N_{\rm e,m}/N_{\rm m}$ that explicitly incorporates two types of overdispersed reproduction \cite[i.e., parental and nonparental variations;][]{Akita_2019}, making it possible to target a species that shows iteroparity (i.e., multiple reproductive cycles during the lifetime) and/or sweepstakes reproductive success. This estimator applying an iteroparous species corresponds to the estimator of the ratio of contemporary effective breeding mother size to the census size, $N_{\rm b,m}/N_{\rm m}$. First, we explain the modeling assumption and sampling scheme. Then, we analytically determine (nearly) the unbiased estimators of $N_{\rm e,m}$, $ 1/N_{\rm m}$, and $N_{\rm e,m}/N_{\rm m}$, which are based on the numbers of MS and/or MO pairs. Finally, by running an individual-based model, we investigate the performance of the estimator and provide a guide for a sample size. It is noteworthy that our modeling framework can be applied to diverse animal species. However, the description of the model focuses on fish species, which are presently the best candidate target of our proposed method. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{THEORY}\label{theory}

In this section, we present the theoretical foundation for estimating $N_{\rm e,m}/N_{\rm m}$. The estimator is based on previous studies that provides the estimator of $N_{\rm e,m}$ \cite[]{Akita_2019} and $1/N_{\rm m}$ \cite[]{Akita2018}. The main contribution of this paper is formulation of the estimator of $N_{\rm e,m}/N_{\rm m}$, presented in Eq.~\ref{NeN_hat2}. The main symbols used in the current paper are summarized in {\bf Table \ref{symbols}}. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Hypothetical population}

We suppose that there is a hypothetical population comprising $N_{\rm m}$ mothers and there is also no population subdivision or spatial structure. In this study, a mature female is called a mother even if she does not produce offspring. For mathematical tractability, we assume that only one spawning ground exists in which the mothers remain for the entire spawning season. Following \cite{Akita_2019}, our modeling framework employs two types of overdispersed reproduction: parental and nonparental variations. Thus, the former indicates a variation caused by the mother's covariates, such as age, weight, and residence time on the spawning ground, while the latter indicates a variation caused by nonrandom stochastic events during a series of reproductive episodes, which are independent of the mother's covariates, such as family-correlated survivorship or the mating behavior effects (e.g., competition for males/females and correlation between mating opportunities of the mother and the number of her offspring). {\bf Figure~1} illustrates a schematic diagram of the effects of parental and nonparental variations exemplified by age-dependent reproduction and family-correlated survival on kinship relationships in a population. Detailed definitions of parental and nonparental variations are stated in \cite{Akita_2019}. {\bf Appendix A} provides the theoretical foundation of both parental and nonparental variations in reproduction.  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Sampling}

To obtain the estimator of $N_{\rm e,m}/N_{\rm m}$, we utilize the number of MS and MO pairs observed in a sample. For the mathematical tractability, only one reproductive season is targeted for sampling. Thus, the sampling method does not affect our modeling framework whether it is invasive or noninvasive. In the population, $n_{\rm M}$ mothers are randomly sampled immediately after the end of the reproductive season. Additionally, in the population, $n_{\rm O}$ offspring are also randomly sampled. The numbers of MS and MO pairs are determined by pairwise comparison of all the sample individuals (${}_{n_{\rm O}}\mathrm{C}_2$ and $n_{\rm M}n_{\rm O}$ comparisons, respectively). As depicted in {\bf Fig~\ref{example}}, six offspring and three mothers are sampled and two MS and three MO pairs are observed. In our modeling framework, if an MS pair also shares a paternal-sibling (PS) relationship, we count it as an MS pair and ignore the existing full-sibling (FS) relationship. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Linking $N_{\rm e,m}/N_{\rm m}$ to kinship relationships}

In this subsection, we provide the theoretical foundation for understanding how $N_{\rm e,m}/N_{\rm m}$ is associated with kinship relationships in a population, based on work presented in previous studies. The rationale is that the observed number of MS and MO pairs have information about $N_{\rm e,m}$ and $N_{\rm m}$, respectively, as noted below. 

First, we consider the relationship between the number of MS pairs and $N_{\rm e,m}$. \cite{Akita_2019} defined the contemporary effective mother size as follows: 
\begin{equation}
N_{\rm e,m} = \frac{1}{\pi_{\rm MS}},
\label{Ne}
\end{equation}
where $\pi_{\rm MS}$ denotes the probability that two offspring share an MS relationship with an arbitrary mother. This definition is related to the inbreeding effective population size \cite[]{nordborg2002separation,wang2009new}. When sampling from a single cohort in a population with overlapping generations, the effective mother size in our definition corresponds to the effective breeding mother size per breeding-time unit (e.g., year), which produces the single cohort and is denoted by $N_{\rm b,m}$ \cite[]{waples1991genetic}. Hereafter, the description of the model focuses on species with discrete generations; thus, we use $N_{\rm e,m}$ to denote the contemporary effective mother size, although $N_{\rm b,m}$ is the appropriate notation in the left-hand side of Eq.~\ref{Ne} when the target species is iteroparous with overlapping generations, as exemplified in {\bf Appendix B}. 

Given the total mother number and the degree of overdisepered reproduction in the population, \cite{Akita_2019} derived $\pi_{\rm MS}$, which is approximately given by
\begin{equation}
\pi_{\rm MS} \approx \frac{c}{N_{\rm m}+c-1},
\label{pi_MS}
\end{equation}
where $c$ indicates combined effect of both parental and nonparental variations and satisfies $\ge1$. Without either parental or nonparental variation (i.e., $c\to1$, see details in {\bf Appendix C}), $\pi_{\rm MS}$ converges to $1/N_{\rm m}$, corresponding to the Poisson variance in reproduction for all mothers. The mathematical description of $c$ is briefly summarized in {\bf Appendix C}.

Next, we consider the relationship between the number of MO pairs and $N_{\rm m}$. It is natural to consider that the probability of a randomly sampled mother and her offspring sharing an MO relationship (denoted by $\pi_{\rm MO}$) can be associated with the total mother number, given by
\begin{equation}
\pi_{\rm MO} = \frac{1}{N_{\rm m}}.
\label{pi_MO}
\end{equation} 
It is noteworthy that $\pi_{\rm MO}$ is independent of the distribution of the offspring number \cite[]{Akita2018}.

Together with Eqs.~\ref{Ne} and \ref{pi_MO}, we finally obtain the ratio of the effective mother size to census size as follows: 
\begin{equation}
\frac{N_{\rm e,m}}{N_{\rm m}} = \frac{\pi_{\rm MO}}{\pi_{\rm MS}},
\label{NeN}
\end{equation}
indicating that $N_{\rm e,m}/N_{\rm m}$ is associated with kinship relationships (i.e., MS and MO) in a population. In other words, when $1/\pi_{\rm MS}$ and $\pi_{\rm MO}$ is estimated from observed MS and MO pairs, respectively, the ratio can also be estimated. Meanwhile, \cite{Akita_2019} obtained an alternative formulation of the ratio using Eqs.~\ref{Ne} and \ref{pi_MS}: 
\begin{eqnarray}
\frac{N_{\rm e,m}}{N_{\rm m}} &=& \frac{1}{\pi_{\rm MS}} \frac{1}{N_{\rm m}} \nonumber\\
&\approx& \frac{1}{c},  
\label{NeN}
\end{eqnarray}
where $N_{\rm m} \gg 1$ is assumed for approximation. This theoretical connection indicates that estimating $N_{\rm e,m}/N_{\rm m}$ corresponds to estimating $1/c$. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Estimator of $N_{\rm e,m}/N_{\rm m}$}

This subsection proposes the estimator of $N_{\rm e,m}/N_{\rm m}$  as follows:
\begin{equation}
\widehat{\left(\frac{N_{\rm e,m}}{N_{\rm m}}\right) } = \widehat{N_{\rm e,m}}\widehat{\left(\frac{1}{N_{\rm m}}\right)}.
\label{NeN_hat1}
\end{equation}
A ``hat'' denotes the estimator of a variable in this study. The requisite condition that satisfies Eq.~\ref{NeN_hat1} is independent of $\widehat{N_{\rm e,m}}$ and $\widehat{1/N_{\rm m}}$. This property will be shown later in this subsection. \cite{Akita_2019} derived the nearly unbiased estimator of $N_{\rm e,m}$, which is given by 
\begin{eqnarray}
\widehat{N_{\rm e,m}} &=& \widehat{\left(\frac{1}{\pi_{\rm MS}}\right)}\nonumber\\
 &=& \frac{\binom{n_{\rm O}}{2}+1}{H_{\rm MS}^{\rm obs}+1},
\label{Ne_hat}
\end{eqnarray}
where $H_{\rm MS}^{\rm obs}$ denotes the observed number of MS pairs in a sample. This estimator works well unless $n_{\rm O}$ is very small, which is based on the idea that the observation of $1/(H_{\rm MS} + 1)$ approximately provides a linear estimator of $N_{\rm e,m}$.

Next, we consider to estimate $1/N_{\rm m}$ by estimating $\pi_{\rm MO}$. By definition of $\pi_{\rm MO}$, we can set its estimator by $H_{\rm MO}^{\rm obs}/(n_{\rm M}n_{\rm O})$, where $H_{\rm MO}^{\rm obs}$ denotes the observed number of MO pairs in a sample. Thus, using Eq.~\ref{pi_MO}, the estimator can be determined as follows:  
\begin{eqnarray}
\widehat{\left(\frac{1}{N_{\rm m}}\right)} &=& \widehat{\pi_{\rm MS}}\nonumber\\
 &=& \frac{H_{\rm MO}^{\rm obs} } {n_{\rm M}n_{\rm O}}.
\label{N_inv_hat}
\end{eqnarray}
Equation~\ref{N_inv_hat} provides a linear estimator of $1/N_{\rm m}$, thus this estimator also works well. Meanwhile, the inverse of the right-hand side in Eq.~\ref{N_inv_hat} is a standard (moment) estimator of $N_{\rm m}$ in the context of CKMR \cite[]{bravington2016close}. 

Finally, substituting $\widehat{N_{\rm e,m}}$ (Eq.~\ref{Ne_hat}) and $\widehat{1/N_{\rm m}}$ (Eq.~\ref{N_inv_hat}) into Eq.~\ref{NeN_hat1}, we obtain the estimator of $N_{\rm e,m}/N_{\rm m}$ as follows:
\begin{equation}
\widehat{\left(\frac{N_{\rm e,m}}{N_{\rm m}}\right) } = \frac{\binom{n_{\rm O}}{2}+1}{H_{\rm MS}^{\rm obs}+1} \frac{H_{\rm MO}^{\rm obs} } {n_{\rm M}n_{\rm O}}.
\label{NeN_hat2}
\end{equation}
Let both $n_{\rm M}$ and $n_{\rm O}$ be given. We numerically confirmed that there is no correlation between $H_{\rm MO}^{\rm obs}$ and $H_{\rm MS}^{\rm obs}$ (results are not shown). To intuitively explain this independency, we consider three mothers ($i=1, 2, 3$) and their offspring, and assume that $(k_1, k_2, k_3)=(3, 1, 1)$ and $(n_{\rm M}, n_{\rm O})=(1,3)$. When the three offspring born to the first mother are sampled (i.e., $H_{\rm MS}^{\rm obs}=3$), the expected number of MO relationship is one ($=1/3\times3 + 1/3\times0 + 1/3\times0$). Meanwhile, when an offspring is sampled from each mother's offspring (i.e., $H_{\rm MS}^{\rm obs}=0$), the expected number of MO relationship is also one ($=1/3\times1 + 1/3\times1 + 1/3\times1$). Therefore, we conclude that both $\widehat{N_{\rm e,m}}$ and $\widehat{1/N_{\rm m}}$ are independent, and $\widehat{N_{\rm e,m}/N_{\rm m}}$ is expected to work well (see details in the {\bf RESULTS} section).  

The bias of $\widehat{N_{\rm e,m}/N_{\rm m} }$ is defined by $b$, which is approximately given by (see {\bf Appendix D} for the derivation)
\begin{eqnarray}
b &=& \mathbb{E}\left[ \widehat{\left(\frac{N_{\rm e,m}}{N_{\rm m}}\right) } \right] - \left(\frac{N_{\rm e,m}}{N_{\rm m}}\right)\nonumber\\
&\approx& -\left(\frac{N_{\rm e,m}}{N_{\rm m}}\right) \left(1-\frac{1}{N_{\rm e,m}}\right)^{\binom{n_{\rm O}}{2}+1}.
\label{bias}
\end{eqnarray}
It is noteworthy that $\widehat{N_{\rm e,m}/N_{\rm m}}$ is downwardly biased, especially when $n_{\rm O}$ is very small. However, this bias may be ignored for a wide range of parameters (see details in the {\bf RESULTS} section). Theoretically, $b$ asymptotically converges to zero as $n_{\rm O}$ increases, making $\widehat{N_{\rm e,m}/N_{\rm m}}$ a nearly unbiased estimator. Moreover, as demonstrated in the {\bf RESULTS} section, it is observed that an extremely skewed reproduction breaks down the unbiasedness (e.g., in the case that $c=$ 20 and 100 in the results). 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Individual-based model}

We developed an individual-based model that tracks kinship relationships to evaluate the estimator's performance (e.g., $\widehat{N_{\rm e,m}/N_{\rm m}}$). The population structure was assumed to be identical to that in the development of the estimators. In addition, the population comprised mothers and their offspring, and it was assumed to follow a Poisson or negative binomial reproduction (the degree of skewness due to the nonparental variation is controlled by a parameter $\phi$; see {\bf Appendix B} for detalis). The expected number of the surviving offspring of a mother (denoted by $\lambda$) followed the density distribution $f(\lambda)$ (which is involved to the parental variation; see {\bf Appendix B} for details). We calculated overdispersion parameter ($c$) from $\phi$ and $f(\lambda)$, as well as confirmed numerically that the value of $c$ gives the same statistics of the estimators even if the combination of $\phi$ and $f(\lambda)$ differs (results are not shown). Therefore, each offspring retained the mother's ID, making it possible to trace an MS and MO relationship.

Let a parameter set ($n_{\rm O}$, $n_{\rm M}$, $N_{\rm m}$, $\phi$, and parameters that determine $f(\lambda)$) be given. We simulated a population history in which $N_{\rm m}$ mothers generated offspring; this process was repeated 100 times. The sampling process for each history was repeated 10{,}000 times, acquiring 1{,}000{,}000 data points that were utilized to construct the distribution of the estimators for each parameter set. Furthermore, true value of $N_{\rm e,m}$ was calculated from $N_{\rm m}$ and $c$ (Eqs.~\ref{Ne} and \ref{pi_MS}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{RESULTS}

We numerically evaluated the performance of $\widehat{N_{\rm e,m}/N_{\rm m}}$ for the case in which the number of mothers, $N_{\rm m}$, and the combined effect of deviation from the Poisson, $c$, were unknown. We changed the parameter values for $N_{\rm m}$ ($10^3$ and $10^4$) and $c$ (1, 10, 20, and 100). In addition, based on a given parameter set ($N_{\rm m}$ and $c$), we mainly addressed the number of samples ($n_{\rm M}$ and $n_{\rm O}$) required to obtain adequate accuracy and precision. In this study, we evaluated the performance of $\widehat{N_{\rm e,m}/N_{\rm m}}$ for specific ranges of the sample sizes (50-200 when $N_{\rm m}=10^3$, and 200-1000 when $N_{\rm m}=10^4$). Meanwhile, other estimators (i.e., $\widehat{N_{\rm e,m}}$ and $\widehat{1/N_{\rm m}}$) are also evaluated and provided in {\bf Supporting Information}. 

First, we evaluated the accuracy of estimators based on their relative bias calculated by applying the individual-based model, which is defined as follows: ``averaged estimator $-$ true value/true value.'' For a given combination of $N_{\rm m}$ and $c$, the value of the relative bias of $\widehat{N_{\rm e,m}/N_{\rm m}}$ is represented on a violin plot for limiting cases where the sample number of mothers and offspring is same (i.e., $n_{\rm M} = n_{\rm O}$), as depicted in {\bf Fig.~\ref{violin}}. Meanwhile, detailed results of the relative bias are represented on a heatmap as a function of $n_{\rm M}$ and $n_{\rm O}$ (see {\bf Fig.~\NeNbias{}} in {\bf Supporting Information}). For most of the investigated parameter sets, we observed that their relative bias is less than 10\%. As expected, the relative bias is not affected by $n_{\rm M}$ since $\widehat{1/N_{\rm m}}$ is exactly an unbiased estimator of $1/N_{\rm m}$ (see Eq.~\ref{Ninv_bias_app} in {\bf Appendix D} and also {\bf Fig.~\Ninvbias{}} in {\bf Supporting Information}). Meanwhile, $\widehat{N_{\rm e,m}}$ is downwardly biased when $n_{\rm O}$ is relatively small to true $N_{\rm e,m}$ (e.g., see {\bf Fig.~\Nebias{}} for $c=1$ in {\bf Supporting Information}), as presented in \cite{Akita_2019}; thus, $\widehat{N_{\rm e,m}/N_{\rm m}}$ is downwardly biased. Contrary to the theoretical prediction for the direction of the bias (Eq.~\ref{bias}), relatively strong overdispersion results in an upwardly bias for $\widehat{N_{\rm e,m}/N_{\rm m}}$ when $N_m$ is relatively small and $c$ is relatively large (e.g., $c=20$ and $100$ in {\bf Fig.~\ref{violin}a}). This inconsistency may be caused by the breakdown of the approximation for deriving $\widehat{N_{\rm e,m}}$ \cite[Eq.~S14 in][]{Akita_2019}. Thus, as described in Eq.~\ref{V_k2}, extremely large $c$ results in a large variance of offspring number, generating a situation in which the behavior of random variable $H_{\rm MS}$ far deviates from the binomial distribution. 

Next, we evaluated the precision of estimators based on their coefficient of variation. As demonstrated in {\bf Fig.~\NeNcv{}} in {\bf Supporting Information}, the value of the coefficient of variation of $\widehat{N_{\rm e,m}/N_{\rm m}}$ is also represented on a heatmap as a function of $n_{\rm M}$ and $n_{\rm O}$; meanwhile, the violin plot ({\bf Fig.~\ref{violin}}) visually provides the degree of precision. For the investigated parameter sets, the degree of the coefficient of variation strongly depends on the sample sizes. As shown in {\bf Figs.~\Necv{} and \Ninvcv{}} in {\bf Supporting Information}, the dependency results from the combined effects of variation of both $\widehat{1/N_{\rm m}}$ and $\widehat{N_{\rm e,m}}$. As $c$ increases, it is noteworthy that the parameter space of sample sizes demonstrating large variation of $\widehat{1/N_{\rm m}}$ (e.g., $CV>30\%$) expands; however, when $c$ is small (e.g., $c=1$), relatively small $n_{\rm O}$ results in large variation of $\widehat{N_{\rm e,m}}$ because of a relatively large $N_{\rm e,m}$. 
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{DISCUSSION}

We theoretically developed a nearly unbiased estimator of the ratio of contemporary effective mother size to the census size ($N_{\rm e,m}/N_{\rm m}$) in a population (Eq.~\ref{NeN_hat2}). The proposed estimator is based on known MO relationship and MS relationships observed within the same cohort, in which sampled individuals in the cohort probably share MO relationships with sampled mothers ({\bf Fig~\ref{example}}). The performance of the estimator (accuracy and precision) was quantitatively evaluated by running an individual-based model ({\bf Fig.~\ref{violin}}; see also {\bf Figs.~\NeNbias{}--~\Ninvcv{}}). Meanwhile, the bias is analytically provided (Eq.~\ref{bias}). Our modeling framework utilizes two types of reproductive variations \cite[]{Akita_2019}: variance of the average offspring number per mother (parental variation, denoted by $f(\lambda)$), and variance of the offspring number across mothers with the same reproductive potential (nonparental variation, denoted by $\phi$). Additionally, these two effects result in a skewed distribution of offspring number and are summarized into one parameter ($c$) in the framework. Thus, our estimator can be calculated from sample sizes of mother and offspring ($n_{\rm M}$ and $n_{\rm O}$, respectively) and the observed numbers of MS and MO pairs ($H_{\rm MS}^{\rm obs}$ and $H_{\rm MO}^{\rm obs}$, respectively), and it does not require other parameters. The rationale for this is the following: i) the frequency of MS and MO pairs contains information about $N_{\rm e,m}$ and $N_{\rm m}$, respectively; ii) the estimators of $N_{\rm e,m}$ and $1/N_{\rm m}$ are independently determined based on a pedigree structure in the population and sample sizes, generating the estimator of $N_{\rm e,m}/N_{\rm m}$ by multiplying both estimators ($\widehat{N_{\rm e,m}}$ and $\widehat{1/N_{\rm m}}$). In this study, although $\widehat{N_{\rm e,m}/N_{\rm m}}$ is considered as a proxy of $\widehat{N_{\rm e}/N}$, our theoretical results can easily be extended to the estimator of the ratio of contemporary effective father size to the census size if fathers are also sampled. The comparison of both ratios could clarify the underlying processes that differentiate between the sexes in the context of reproductive ecology.  

The novelty of this study is that $\widehat{N_{\rm e,m}/N_{\rm m}}$ can be obtained only from the genetic data, and there are numerous advantages in using the proposed estimator instead of separately estimating $N_{\rm e}$ (via genetical method) and $N$ (via non-genetical method). First, sampling and analyzing designs have become substantially simplified. Requirements for the proposed estimator are sampling of mothers and (potentially) their offspring in an appropriate time, and the extraction of their DNA that satisfies an adequate number of markers for kinship detection. In addition, both MO and MS pairs can be detected by a applying unified framework of genetic analyzes (there are many algorithms to detect kinship pairs from single nucleotide polymorphisms (SNPs) or short tandem repeats (STRs)), although an MS pair involves many more DNA markers (e.g., several thousands of SNPs are required for detection) than an MO pair (e.g., several hundreds of SNPs are required for detection). Second, our theoretical results guide sample sizes ($n_{\rm M}$ and $n_{\rm O}$) to ensure the required accuracy and precision, especially if the order of the number of effective mothers is approximately known. This is due to the simple formulation of the estimator determined only by the observed values (Eq.~\ref{NeN_hat2}). Third, the proposed estimator directly reflects the amounts of $N_{\rm e,m}$ and $N_{\rm m}$ at the same timing (i.e., immediately after the end of the reproductive season), leading to a clear interpretation of the results, especially for genetic monitoring. For example, when the strong cohort is added to the spawning population in the beginning of the year, the estimator of $N_{\rm e}$ without reflecting this addition may results in an inappropriate estimation of $N_{\rm e}/N$ \cite[details of the temporal scale relevant to estimated $N_{\rm e}$ for each method were discussed in][]{Wang:2016aa}. 

Our modeling framework is presented by combining the context of the sibship assignment method (for estimating $N_{\rm e,m}$) and the CKMR method (for estimating $1/N_{\rm m}$), which defines a kinship-oriented estimation of effective/census population size. Improvements to these methods directly contribute to the estimation of $N_{\rm e,m}/N_{\rm m}$. Furthermore, the original theory of the sibship assignment method requires HS and FS pairs but does not require a distinction between the MS and PS pairs \cite[]{wang2009new}. This is a significant advantage due to the difficulty of the distinction from genetic data. However, the limitation of using MS or PS pair enables us to employ a nearly unbiased estimator of $N_{\rm e}$ for particular sex \cite[]{Akita_2019}, which greatly improves the accuracy of the estimation of the $N_{\rm e,m}$ in this study and thus that of $N_{\rm e,m}/N_{\rm m}$ (see {\bf Fig.~E\ref{violin_wang}} in {\bf Appendix E}). It is noteworthy that the estimator of $1/N$ is given by 
\begin{equation}
\widehat{\left(\frac{1}{N}\right)} = \frac{H_{\rm PO}^{\rm obs} } {2n_{\rm P}n_{\rm O}},
\label{N_inv_hat2}
\end{equation}
where $n_{\rm P}$ and $H_{\rm PO}^{\rm obs}$ denotes the sample size of the parent and the observed number of parent--offspring (PO) pairs in a sample, respectively \cite[]{bravington2016close}. The development of the unbiased estimator of $N_{\rm e}$ without a distinction between MS and PS pairs that could provide an unbiased estimator of $N_{\rm e}/N$ coupled with Eq.~\ref{N_inv_hat2}, is a study for the future. Furthermore, using cross-cohort HS pairs, the CKMR method also provides the estimator of $N$ \cite[]{bravington2016close} that does not require the sampling of the parent, which probably provides the estimator of $N_{\rm e}/N$ only from unmatured samples. This perspective of the study will also be conducted in the future.

Finally, we note the advantage of partitioning variance in reproductive success into two components. As denoted in Eq.~\ref{c} in {\bf Appendix C}, the combined effect of parental and nonparental variations is given by 
\begin{equation}
c = ({\rm effect\ of\ nonparental\ variation}) \times ({\rm effect\ of\ parental\ variation}).
\label{partition}
\end{equation}
Meanwhile, as denoted in Eq.~\ref{NeN}, the estimator of $N_{\rm e,m}/N_{\rm m}$ provides the information for the lefthand-side of Eq.~\ref{partition}. Thus, when we obtain parental variation information from the life-history table or from other species, the estimator of $N_{\rm e,m}/N_{\rm m}$ can also estimate the degree of nonparental variation. This procedure provides an insight into sweepstake reproduction or family-correlated sampling of offspring (i.e., nonrandom sampling), although the theoretical formulation and its evaluation remain a task for future research. Alternatively, Waples et al. (2018) developed a genetical method for estimating $N_{\rm e}/N$ and $N_{\rm b}/N$ via estimating the degree of nonparental variation from fecundity data in southern bluefin tuna. 

\end{comment}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{ACKNOWLEDGMENTS}
The author thanks Y. Tsukahara and N. Suzuki for fruitful discussions. This work was supported by JSPS KAKENHI Grant Number 19K06862 and 20H03012.

\section*{CONFLICT OF INTEREST}
The author declares no conflict of interest.

\section*{AUTHOR CONTRIBUTIONS}
{\bf Tetsuya Akita:} Conceptualization (lead); formal analysis (lead); funding acquisition (lead); methodology (lead); writing--original draft (lead); writing--review and editing (lead).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{DATA ACCESSIBILITY}
No datasets were generated or analyzed in this study.

\bibliographystyle{apacite}
\bibliography{akita}

\clearpage

\renewcommand{\arraystretch}{0.6}
\begin{table}[tb]
%\centering
   \caption[]{Table 1: The list of mathematical symbols employed in the main text}
    \textbf {}\\[-4mm]
    \begin{tabular}{llc} \hline
       & & \\
	$n_{\rm P,1}, n_{\rm P, 2}$			& Sampled number of parents from the population 1 and 2\\ 
		                						& \\
	$n_{\rm O, 1}, n_{\rm O, 2}$			& Sampled number of offspring from the population 1 and 2\\ 
		                						& \\
	$N_{1}, N_{2}$						& Number of parents in the population 1 and 2 when sampled offspring are born\\
		                						& \\
	$M$								& Number of survived migrants of parents from the population 1 to population 2\\
		                						& \\
	$m$								& Migration rate of parents from the population 1 to population 2, defined by $M/N_1$.\\
		                						& \\
	$r$								& Sex ratio\\
		                						& \\
	$\pi_{\rm PO,1}, \pi_{\rm PO,2}$		& Probability that a randomly selected pair (parent and offspring) \\
	                							& shares a parent-offspring relationship within the population 1 and 2\\
									& \\
	$\pi_{\rm PO, bet}$					& Probability that a randomly selected pair (parent and offspring) \\
	                							& shares a parent-offspring relationship between the population 1 and 2\\
									& \\
	$\pi_{\rm HS, bet}$					& Probability that a randomly selected pair (two offspring) \\
	                							& shares a half-sibling relationship between the population 1 and 2\\
					                			& \\
	$\lambda_{i,1}, \lambda_{j,2}$			& Expected number of surviving offspring of parent $i$ and $j$ at sampling in the population 1 and 2\\
		                						& \\
	$\lambda_{M,l,1}, \lambda_{M,l,2}$		& Expected number of surviving offspring of migrant $l$ at sampling in the population 1 and 2\\
		                						& \\
	$k_{i,1}, k_{j,2}$					& Number of surviving offspring born to parent $i$ and $j$ in the population 1 and 2\\ 
	                							& \\
	$H_{\rm PO, 1}, H_{\rm PO, 2}$		& Number of parent-offspring pairs observed in samples within the population 1 and 2\\ 
	                							& \\
	$H_{\rm PO, bet}$					& Number of parent-offspring pairs observed in samples between the population 1 and 2\\ 
	                							& \\
	$H_{\rm HS, bet}$					& Number of half-sibling pairs observed in samples between the population 1 and 2\\ 
	                							& \\              		
	\hline
    \end{tabular}
    \label{symbols} 
\\Subscription ``1'' and ``2'' indicates the quantity in the population 1 during the first year and in the population 2 during the second year, respectively. 
\end{table}
\renewcommand{\arraystretch}{1}

\clearpage

\renewcommand{\arraystretch}{0.6}
\begin{table}[tb]
\begin{center}
   \caption[]{Table 2: Summary of proposed estimators for required parameters and kinship types}
    \textbf {}\\[-0mm]
    \begin{tabular}{ccccccccc} \hline
       	\\
	Estimator			& $N_1$ 		& $N_2$ 		& $n_{\rm O, 1}$	& $n_{\rm O, 2}$	& $n_{\rm P, 1}$	& $n_{\rm P, 2}$	& Required kinship type\\
	\\
	\hline
	\\
	$\widehat{M_1}$	& given 		& given 		& \checkmark		& \checkmark 		&				&				& HSP\\ 
		                						& \\
	$\widehat{M_2}$	& given		& given		& \checkmark		& 				&				& \checkmark 		& POP\\
		                						& \\
	$\widehat{M_3}$	& given		& given		& \checkmark		&  \checkmark		&				& \checkmark 		& HSP \& POP\\
		                						& \\
	$\widehat{M_4}$	& given		& estimated	& \checkmark		&  \checkmark		&				& \checkmark 		& HSP \& POP\\
		                						& \\
	$\widehat{M_5}$	& estimated	& estimated	& \checkmark		&  \checkmark		& \checkmark		& \checkmark 		& HSP \& POP\\
									& \\
	$\widehat{m_1}$	& ---			& given		& \checkmark		& \checkmark 		&				&				& HSP\\ 
									& \\
	$\widehat{m_2}$	& ---			& given		& \checkmark		& 				&				& \checkmark 		& POP\\					                			& \\
	$\widehat{m_3}$	& ---			& given 		& \checkmark		&  \checkmark		&				& \checkmark 		& HSP \& POP\\
		                						& \\
	$\widehat{m_4}$	& ---			& estimated	& \checkmark		&  \checkmark		& 				& \checkmark 		& HSP \& POP\\
		                						& \\
	\hline
    \end{tabular}
    \label{parameter} 
\end{center} 
\end{table}
\renewcommand{\arraystretch}{1}

\clearpage

\newcommand{\figcapa}{(a) Hypothetical populations with $N_{1}=16$, $N_{2}=14$, and $M=6$. Upper and lower square indicates individuals belonging to the population 1 before migration (at sample timing in the first year) and individuals belonging to the population 2 after reproduction (at sample timing in the second year), respectively. The open circles on the left side, right side, and the center represent mothers, fathers, and their offspring, respectively. The thin line denotes parent-offspring relationship. The bold arrow denotes the migration and the symbol x denotes a failure to survive at sampling in the second year. Sampled individuals are labeled with an index number. The number of sampled individuals in this example: $n_{\rm P, 1}=4$, $n_{\rm O, 1}=5$, $n_{\rm P, 2}=6$, $n_{\rm O, 2}=4$; the numbers of kinship pairs: $H_{\rm PO, bet}=1$ (i.e., ``7-10'' pair), $H_{\rm HS, bet}=2$ (i.e., ``8-16'' and ``9-16'' pairs), $H_{\rm PO, 1}=3$ (i.e., ``1-6'', ``3-5'' and ``4-7'' pairs), and $H_{\rm PO, 2}=2$ (i.e., ``11-17'' and ``15-16'' pairs). (b) The phases of the events relevant to this study along the time line.}

\newcommand{\figcapb}{Violin plots showing the distribution of relative bias in our estimator of $M$ for various values sample sizes, parent numbers and migration rate. Filled circles represent the mean values. Sample sizes for parents and offspring are identical (i.e., $n=n_{\rm P,1}=n_{\rm P,2}=n_{\rm O,1}= n_{\rm O,2}$) and parent sizes in the two populations are also identical (i.e., $N=N_1=N_2$), which are indicated in the legend. Migration rate $m$ is specified by $N_1/M$. For the demonstration purposes, the distribution is truncated, although the mean values are calculated including the truncated values. }

\newcommand{\figcapsg}{Violin plots showing the distribution of relative bias of $N_{\rm e}/N$ (denoted in Eq.~\ref{NeN_wang}) for various sample sizes. Filled circles represent the mean values. The sample numbers of parents and offspring are identical (i.e., $n=n_{\rm P} = n_{\rm O}$) and indicated in the legend. For demonstration purposes, the distribution is truncated, although the mean values are calculated including the truncated values. (a) $N=2{,}000$, (b) $N=20{,}000$.}

%%%FIGURE 1%%%
\begin{figure}[!h]
	\begin{center}
		\includegraphics[width=0.7\textwidth]{/Users/akita/Dropbox/research/close_kin/Mig/Figs/cartoon.eps}
		\caption{{\bf FIGURE 1} \figcapa{}}
		\label{cartoon}
	\end{center}
\end{figure}
%%%%%%%%%%%

%%%FIGURE 2%%%
\begin{figure}[!h]
	\begin{center}
		\includegraphics[width=1\textwidth]{/Users/akita/Dropbox/research/close_kin/Mig/Figs/violins.eps}
		\caption{{\bf FIGURE 2} \figcapb{}}
		\label{violins}
	\end{center}
\end{figure}
%%%%%%%%%%%



\clearpage

\section*{APPENDIX 1}
\setcounter{equation}{0}
\renewcommand{\theequation}{A\arabic{equation}}

\section*{Reproductive potential}

\renewcommand{\theequation}{A\arabic{equation}}
Here, we introduce the concept of the reproductive potential of parent $i$ and $j$ in the population 1 and 2, respectively, which are defined as the expected number of surviving offspring at sampling time, denoted by $\lambda_{i,1}$ and $\lambda_{j,2}$ ($i=(1, \ldots, N_1)$ and $j=(1, \ldots, N_2)$). The reproductive potential is determined by several factors, including the parent's age, weight, residence time on the spawning ground. It should be noted that the magnitude of this parameter includes information about the survival rate of the offspring, the number of days after egg hatching, and the egg number; this implies that the parameter reflects the sample timing. It should also be noted that the modeling framework does not depend on whether the reproductive potential is heritable or not.

\section*{APPENDIX 2}
\section*{Derivation of Equations~\ref{HS-1} and \ref{PO-1} when reproductive potential is variable among parents}

In the main text, we ignore the variation of reproductive potential among parents (i.e., both $\lambda_{i,1}$ and $\lambda_{j,2}$ are constant) to derive $\pi_{\rm HS,bet}$ and $\pi_{\rm PO,bet}$. Let $k_{i,1}$ and $k_{j,2}$ be the number of surviving offspring of parent $i$ and $j$ at sampling in the population 1 and 2, respectively, and $k_{i,1}$ and $k_{j,2}$ is assumed to follow a kind of discrete distribution (e.g., negative binomial distribution) with mean $\lambda_{i,1}$ and $\lambda_{j,2}$. Without loss of generality, we set the index such that parents with $i=1$ to $M$ in the population 1 and $j=1$ to $M$ in the population 2 are identical migrants; for example, the parent with $i=1$ reproduce $k_{1,1}$ offspring (in the population 1) and then reproduce $k_{1,2}$ offspring (in the population 2) after migration. Giving $k_{i,1}$ and $k_{j,2}$, the conditional probability that two offspring sampled in the population 1 and 2 share an HS relationship is
\begin{align}
\pi_{\rm HS,bet} | _{\boldsymbol{k_1, k_2}} &= \frac{ 2\sum_{i=1}^M k_{i,1} } { \sum_{i=1}^{N_1} k_{i,1} } \frac{ 2\sum_{j=1}^M k_{j,2} } { \sum_{j=1}^{N_2} k_{j,2} } \frac{1}{M}, 
\end{align}
where $\boldsymbol{k_1}=(k_{1,1}, \ldots, k_{M,1}, \ldots, k_{N_1,1})$ and $\boldsymbol{k_2}=(k_{1,2}, \ldots, k_{M,2}, \ldots, k_{N_2,2})$. It should be noted that $k_{i,1}$ and $k_{j,1}$ is a random variable with mean $\lambda_{i,1}$ and $\lambda_{j,2}$, respectively. By taking the expectation over the distribution of offspring number, the conditional probability is approximately given by
\begin{align}
\pi_{\rm HS,bet} | _{\boldsymbol{\lambda_1, \lambda_2}} &= \mathbb{E}[\pi | _{\boldsymbol{k_1, k_2}}] \nonumber\\
&= \frac{4}{M} \mathbb{E}\left[\frac{ \sum_{i=1}^M k_{i,1} } { \sum_{i=1}^{N_1} k_{i,1} } \frac{ \sum_{j=1}^M k_{j,2} } { \sum_{j=1}^{N_2} k_{j,2} } \right]   \nonumber\\
&\approx \frac{4}{M} \frac{ \mathbb{E}\left[ \sum_{i=1}^M k_{i,1} \sum_{j=1}^M k_{j,2} \right] } {\mathbb{E}\left[ \sum_{i=1}^{N_1} k_{i,1} \sum_{j=1}^{N_2} k_{j,2}\right]} \nonumber\\
&= \frac{4}{M} \frac{ \sum_{i=1}^M \lambda_{i,1} \sum_{j=1}^M \lambda_{j,2} } {\sum_{i=1}^{N_1} \lambda_{i,1} \sum_{j=1}^{N_2} \lambda_{j,2}},
\end{align}
where $\boldsymbol{\lambda_1}=(\lambda_{1,1}, \ldots, \lambda_{M,1}, \ldots, \lambda_{N_1,1})$ and $\boldsymbol{\lambda_2}=(\lambda_{1,2}, \ldots, \lambda_{M,2}, \ldots, \lambda_{N_2,2})$. From the second to the third line, we use the approximation that $\mathbb{E}[g1(k)/g2(k)] \approx \mathbb{E}[g_1(k)] / \mathbb{E}[g_2(k)]$. From the third to the forth line, we use the relationship that $\mathbb{E}[k_{i,1}k_{j,2} | _{\lambda_{i,1}, \lambda_{j,2}}] = \mathbb{E}[k_{i,1}|_{\lambda_{i,1}}]\mathbb{E}[k_{j,2}|_{\lambda_{j,2}}]$, implying statistical independence of offspring number before and after parental movement. In other words, the conditional probability does not affected by $\mathbb{V}[k|_\lambda]$. We assume that $\lambda_{i,1}$ and $\lambda_{j,2}$ is also a random variable followed by an arbitral function with mean ${\bar \lambda_{1}}$ and ${\bar \lambda_{2}}$, respectively. By taking the expectation over $\lambda$ and applying a similar approximation, the unconditional probability is given by
\begin{align}
\pi_{\rm HS,bet} &= \mathbb{E}[\pi | _{\boldsymbol{\lambda_1, \lambda_2}}] \nonumber\\ 
&= \frac{4}{M} \mathbb{E}\left[\frac{ \sum_{i=1}^M \lambda_{i,1} } { \sum_{i=1}^{N_1} \lambda_{i,1} } \frac{ \sum_{j=1}^M \lambda_{j,2} } { \sum_{j=1}^{N_2} \lambda_{j,2} } \right]   \nonumber\\
&\approx \frac{4}{M} \frac{ \mathbb{E}\left[ \sum_{i=1}^M \lambda_{i,1} \sum_{j=1}^M \lambda_{j,2} \right] } {\mathbb{E}\left[ \sum_{i=1}^{N_1} \lambda_{i,1} \sum_{j=1}^{N_2} \lambda_{j,2}\right]} \nonumber\\
&= \frac{4}{M} \frac{M^2 {\bar \lambda_1} {\bar \lambda_2}}{N_1 N_2 {\bar \lambda_1} {\bar \lambda_2}}\nonumber\\
&= \frac{4M}{N_{1}N_{2}},
\label{App2}
\end{align}
which provides the same formulation described in Eq.\ref{HS-1}. It should be noted that, from the third to the forth line, we assume that $\lambda_{l,1}$ and $\lambda_{l,2}$ ($l = 1, \ldots, M$) are independent variables (i.e., $\mathbb{E}[\lambda_{l,1}\lambda_{l,2}] = {\bar \lambda_{1}}{\bar \lambda_{2}}$), implying variable reproductive potential of an identical parent before and after migration. 

Next, we derive the probability that offspring sampled in the population 1 and a parent sampled in the population 2 share an PO relationship ($\pi_{\rm PO,bet}$) under the flexible settings of $\lambda$, which is similar to the derivation of $\pi_{\rm HS,bet}$. The conditional probability is given by
\begin{align}
\pi_{\rm PO,bet} | _{\boldsymbol{k_1, k_2}} &= \frac{ 2\sum_{i=1}^M k_{i,1} } { \sum_{i=1}^{N_1} k_{i,1} } \frac{ \sum_{j=1}^M k_{j,2} } { \sum_{j=1}^{N_2} k_{j,2} } \frac{1}{M}.
\end{align}
By taking the expectation over $k$ and $\lambda$, in the same manner as noted above, the unconditional probability is approximately given by
\begin{align}
\pi_{\rm PO,bet} &= \mathbb{E}[\mathbb{E}[\pi | _{\boldsymbol{k_1, k_2}}]] \nonumber\\ 
&\approx  \frac{2M}{N_{1}N_{2}},
\end{align}
which provides the same formulation described in Eq.\ref{PO-1}.

\section*{APPENDIX 3}

\section*{Difference in reproductive potential between migrants and non-migrants}

In the process of the derivation of $\pi_{\rm HS,bet}$ and $\pi_{\rm PO,bet}$ in {\bf APPENDIX 2}, we ignore covariation between migration and reproductive potential. Here, we consider the situation in which migrants have a distinguishable distribution of reproductive potential from non-migrant parents. Let $\lambda_{i,1}$, $\lambda_{j,2}$, $\lambda_{M,l,1}$ and $\lambda_{M,l,2}$ be a reproductive potential of non-migrant in the population 1 and 2 and migrants in the population 1 and 2 with mean ${\bar \lambda_{1}}$, ${\bar \lambda_{2}}$, ${\bar \lambda_{M,1}}$ and ${\bar \lambda_{M,2}}$, respectively. Under this setting, $\pi_{\rm HS,bet}$ can be written by
\begin{align}
\pi_{\rm HS,bet} &\approx \frac{4}{M}  \frac{ \mathbb{E}\left[ \sum_{l=1}^M \lambda_{M,l,1} \sum_{l=1}^M \lambda_{M,l,2} \right]} {\mathbb{E}\left[ \left(\sum_{l=1}^{M} \lambda_{M,l,1} + \sum_{i=M+1}^{N_1} \lambda_{i,1}\right) \left(\sum_{l=1}^{M} \lambda_{M,l,2} + \sum_{j=M+1}^{N_2} \lambda_{j,2}\right) \right] }\nonumber\\ 
&= \frac{4}{M} \frac{ M^2 {\bar \lambda_{M,1}} {\bar \lambda_{M,2}} } { M {\bar \lambda_{M,1}} + (N_1 - M) {\bar \lambda_1} + M {\bar \lambda_{M,2}} + (N_2 - M) {\bar \lambda_2} }.
\label{App3}
\end{align}
If ${\bar \lambda_{M,1}} = {\bar \lambda_{1}}$ and ${\bar \lambda_{M,2}} = {\bar \lambda_{2}}$, Eq.~\ref{App3} reduces to Eq.\ref{App2}. This formulation include reproductive potential terms, so that distinct reproductive potential between migrants and non-migrants vanishes the usefulness from proposed HS-based estimators (this is also applied to PO-based estimators proposed in this paper). 

\clearpage

%\begin{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section*{Supporting Information}

%\setcounter{figure}{0}
%\newcommand{\figcapsa}{Heatmap showing the relative bias of $\widehat{N_{\rm e,m}/N_{\rm m}}$ as a function of both $n_{\rm M}$ and $n_{\rm O}$. The value of the relative bias is indicated in the legend. The value of the combined effect of parental and nonparental variations increases from left to right ($c=1, 10, 20$, and $100$). (a) $N_{\rm m}=1{,}000$, (b) $N_{\rm m}=10{,}000$. }

%\newcommand{\figcapsb}{Heatmap showing the relative bias of $\widehat{N_{\rm e,m}}$ as a function of both $n_{\rm M}$ and $n_{\rm O}$. The value of the relative bias is indicated in the legend. The value of the combined effect of parental and nonparental variations increases from left to right ($c=1, 10, 20$, and $100$). (a) $N_{\rm m}=1{,}000$, (b) $N_{\rm m}=10{,}000$. }

%\newcommand{\figcapsc}{Heatmap showing the relative bias of $\widehat{1/N_{\rm m}}$ as a function of both $n_{\rm M}$ and $n_{\rm O}$. The value of the relative bias is indicated in the legend. The value of the combined effect of parental and nonparental variations increases from left to right ($c=1, 10, 20$, and $100$). (a) $N_{\rm m}=1{,}000$, (b) $N_{\rm m}=10{,}000$. }

%\newcommand{\figcapsd}{Heatmap showing the coefficient of variation of $\widehat{N_{\rm e,m}/N_{\rm m}}$ as a function of both $n_{\rm M}$ and $n_{\rm O}$. The value of the coefficient of variation is indicated in the legend. The value of the combined effect of parental and nonparental variations increases from left to right ($c=1, 10, 20$, and $100$). (a) $N_{\rm m}=1{,}000$, (b) $N_{\rm m}=10{,}000$.}

%\newcommand{\figcapse}{Heatmap showing the coefficient of variation of $\widehat{N_{\rm e,m}}$ as a function of both $n_{\rm M}$ and $n_{\rm O}$. The value of the coefficient of variation is indicated in the legend. The value of the combined effect of parental and nonparental variations increases from left to right ($c=1, 10, 20$, and $100$). (a) $N_{\rm m}=1{,}000$, (b) $N_{\rm m}=10{,}000$.}

%\newcommand{\figcapsf}{Heatmap showing the coefficient of variation of $\widehat{1/N_{\rm m}}$ as a function of both $n_{\rm M}$ and $n_{\rm O}$. The value of the coefficient of variation is indicated in the legend. The value of the combined effect of parental and nonparental variations increases from left to right ($c=1, 10, 20$, and $100$). (a) $N_{\rm m}=1{,}000$, (b) $N_{\rm m}=10{,}000$.}

%%%FIGURE S1%%%
%\begin{figure}[!h]
%	\begin{center}
%		\includegraphics[width=1\textwidth]{figs/NeN_bias.pdf}
%		\caption{{\bf FIGURE S1} \figcapsa{}}
%		\label{NeN_bias}
%	\end{center}
%\end{figure}
%%%%%%%%%%%

%%%FIGURE S2%%%
%\begin{figure}[!h]
%	\begin{center}
%		\includegraphics[width=1\textwidth]{figs/Ne_bias.pdf}
%		\caption{{\bf FIGURE S2} \figcapsb{}}
%		\label{Ne_bias}
%	\end{center}
%\end{figure}
%%%%%%%%%%%

%%%FIGURE S3%%%
%\begin{figure}[!h]
%	\begin{center}
%		\includegraphics[width=1\textwidth]{figs/Ninv_bias.pdf}
%		\caption{{\bf FIGURE S3} \figcapsc{}}
%		\label{Ninv_bias}
%	\end{center}
%\end{figure}
%%%%%%%%%%%

%%%FIGURE S4%%%
%\begin{figure}[!h]
%	\begin{center}
%		\includegraphics[width=1\textwidth]{figs/NeN_cv.pdf}
%		\caption{{\bf FIGURE S4} \figcapsd{}}
%		\label{NeN_cv}
%	\end{center}
%\end{figure}
%%%%%%%%%%%

%%%FIGURE S5%%%
%\begin{figure}[!h]
%	\begin{center}
%		\includegraphics[width=1\textwidth]{figs/Ne_cv.pdf}
%		\caption{{\bf FIGURE S5} \figcapse{}}
%		\label{Ne_cv}
%	\end{center}
%\end{figure}
%%%%%%%%%%%

%%%FIGURE S6%%%
%\begin{figure}[!h]
%	\begin{center}
%		\includegraphics[width=1\textwidth]{figs/Ninv_cv.pdf}
%		\caption{{\bf FIGURE S6} \figcapsf{}}
%		\label{Ninv_cv}
%	\end{center}
%\end{figure}
%%%%%%%%%%%
%\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\end{comment}

\end{spacing}
\end{document}